<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultima 29 Pro Max - By PRITAM</title>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --gold: #ffcc00; --felt: #074a1d; --border: #3d2b1f; --inr: #10b981; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #020617; color: white; height: 100vh; overflow: hidden; }
        .hidden { display: none !important; }
        
        /* Lobby */
        #lobby-view { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle, #1e1b4b, #020617); }
        .auth-card { background: rgba(30, 41, 59, 0.9); padding: 40px; border-radius: 25px; width: 90%; max-width: 400px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        
        /* Table Area */
        #game-view { height: 100vh; display: flex; flex-direction: column; }
        .casino-floor { flex: 1; display: flex; align-items: center; justify-content: center; perspective: 1000px; }
        .table-29 { 
            width: 95vw; height: 60vh; max-width: 800px; background: radial-gradient(circle, var(--felt) 50%, #042410);
            border: 12px solid var(--border); border-radius: 180px; position: relative;
            box-shadow: 0 40px 80px rgba(0,0,0,0.8), inset 0 0 100px rgba(0,0,0,0.5);
            transform: rotateX(10deg);
        }
                .player-slot { position: absolute; width: 80px; text-align: center; }
        .pos-bottom { bottom: -60px; left: 50%; transform: translateX(-50%); }
        .pos-top { top: -60px; left: 50%; transform: translateX(-50%); }
        .pos-left { left: -70px; top: 50%; transform: translateY(-50%); }
        .pos-right { right: -70px; top: 50%; transform: translateY(-50%); }
        
        .pfp { width: 60px; height: 60px; border-radius: 15px; border: 3px solid var(--gold); background: #111; }
        .p-name { font-size: 12px; font-weight: bold; color: var(--gold); margin-top: 5px; }

        /* INR Chips */
        .bet-dock { height: 100px; background: #000; display: flex; align-items: center; justify-content: center; gap: 15px; border-top: 2px solid var(--gold); }
        .chip { width: 55px; height: 55px; border-radius: 50%; border: 3px dashed rgba(255,255,255,0.4); display: flex; align-items: center; justify-content: center; font-weight: 900; cursor: pointer; font-size: 12px; }
        .c-50 { background: #4caf50; } .c-100 { background: #e91e63; } .c-500 { background: #2196f3; } .c-5000 { background: var(--gold); color: black; }
        
        .pot-inr { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; font-size: 28px; color: var(--gold); font-weight: 900; }
    </style>
</head>
<body>
    <div id="lobby-view">
        <h1 style="color: var(--gold); font-size: 3.5rem; margin-bottom: 20px;">ULTIMA 29</h1>
        <div class="auth-card">
            <input type="text" id="p-name-in" placeholder="Enter Name" style="width:100%; padding:15px; border-radius:12px; border:none; margin-bottom:20px; background:#111; color:white;">
            <div style="display: flex; gap: 10px;">
                <button onclick="enterGame('player')" style="flex:1; padding:15px; background:var(--gold); border:none; border-radius:12px; font-weight:900; cursor:pointer;">PLAY (INR)</button>
                <button onclick="enterGame('spectator')" style="flex:1; padding:15px; background:#333; color:white; border:none; border-radius:12px; cursor:pointer;">WATCH</button>
            </div>
            <p style="margin-top:20px; font-size:10px; opacity:0.5;">DEV BY PRITAM</p>
        </div>
    </div>

    <div id="game-view" class="hidden">
        <div style="padding:15px; background:#000; border-bottom:1px solid var(--gold); display:flex; justify-content:space-between;">
            <div style="color:var(--gold); font-weight:900;">WALLET: ₹<span id="wallet-amt">5000</span></div>
            <div id="spec-info">Spectators: 0</div>
        </div>
        <div class="casino-floor">
            <div class="table-29">
                <div class="player-slot pos-bottom"><div class="pfp"></div><div class="p-name" id="name-0">You</div></div>
                <div class="player-slot pos-left"><div class="pfp"></div><div class="p-name" id="name-1">Pilot 1</div></div>
                <div class="player-slot pos-top"><div class="pfp"></div><div class="p-name" id="name-2">Pilot 2</div></div>
                <div class="player-slot pos-right"><div class="pfp"></div><div class="p-name" id="name-3">Pilot 3</div></div>
                <div class="pot-inr">₹<span id="pot-amt">0</span></div>
            </div>
        </div>
        <div class="bet-dock">
            <div class="chip c-50" onclick="makeBet(50)">₹50</div>
            <div class="chip c-100" onclick="makeBet(100)">₹100</div>
            <div class="chip c-500" onclick="makeBet(500)">₹500</div>
            <div class="chip c-5000" onclick="makeBet(5000)">₹5K</div>
        </div>
    </div>
    <script>
    const socket = io();
    let wallet = 5000;
    let myRole = 'player';

    function enterGame(role) {
        const nameInput = document.getElementById('p-name-in').value.trim();
        if(!nameInput) return alert("Name de age!");

        myRole = role;
        // Blank screen fix: Remove hidden, set display flex
        document.getElementById('lobby-view').classList.add('hidden');
        const gView = document.getElementById('game-view');
        gView.classList.remove('hidden');
        gView.style.display = 'flex';

        socket.emit('join-table', { 
            tableID: "ROCKET-01", 
            username: nameInput, 
            role: myRole, 
            coins: wallet 
        });
    }

    function makeBet(amt) {
        if(myRole !== 'player') return alert("Tui spectator, bet korte parbi na!");
        if(wallet < amt) return alert("Paisa nai!");
        wallet -= amt;
        document.getElementById('wallet-amt').innerText = wallet;
        socket.emit('place-bet', { tableID: "ROCKET-01", amount: amt });
    }

    socket.on('bet-updated', (pot) => {
        document.getElementById('pot-amt').innerText = pot;
    });

    socket.on('table-update', (data) => {
        document.getElementById('spec-info').innerText = `Spectators: ${data.spectators.length}`;
        data.players.forEach((p, i) => {
            if(document.getElementById(`name-${i}`)) {
                document.getElementById(`name-${i}`).innerText = p.username;
            }
        });
    });
    </script>
    <script>
    // 15 min auto-delete notification
    console.log("System: Data cleanup every 15 mins active.");
    
    window.onbeforeunload = function() {
        return "Game chere jabi?";
    };
</script>
</body>
</html>
